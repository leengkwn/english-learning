<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§© 400å–®å­—æ‹¼åœ–ç‹ (å°å­¸ç‰ˆ)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }

        /* æ¨™é¡Œ */
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* å®¹å™¨ */
        .container {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        /* å–®å…ƒé¸æ“‡ */
        .unit-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .unit-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .unit-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .unit-card h2 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .unit-card p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* éŠæˆ²å€ */
        .game-area {
            display: none;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 10px;
            color: white;
            font-weight: bold;
        }

        /* ä¸­æ–‡æç¤ºå€ */
        .chinese-hint {
            text-align: center;
            margin: 30px 0;
            padding: 30px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 15px;
            color: white;
        }

        .chinese-hint-label {
            font-size: 1.2em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .chinese-word {
            font-size: 3em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        /* èªéŸ³æŒ‰éˆ• */
        .speaker-icon {
            font-size: 3em;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            color: white;
            margin-top: 10px;
        }

        .speaker-icon:hover {
            transform: scale(1.2);
        }

        .speaker-icon:active {
            transform: scale(0.9);
        }

        /* ç­”æ¡ˆå€ (æ‹–æ”¾ç›®æ¨™) */
        .answer-area {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 30px 0;
            min-height: 80px;
            flex-wrap: wrap;
        }

        .letter-slot {
            width: 60px;
            height: 80px;
            border: 3px dashed #667eea;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            background: rgba(102, 126, 234, 0.1);
            transition: all 0.3s;
        }

        .letter-slot.drag-over {
            background: rgba(102, 126, 234, 0.3);
            border-color: #4facfe;
            transform: scale(1.1);
        }

        .letter-slot.filled {
            border-style: solid;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .letter-slot.correct {
            border-style: solid;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            border-color: #38ef7d;
        }
        
        .letter-slot.wrong {
            border-style: solid;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border-color: #ff6b6b;
            animation: wrongShake 0.5s ease;
        }
        
        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* å­—æ¯æ±  (æ‹–æ›³ä¾†æº) */
        .letter-pool {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 30px 0;
            flex-wrap: wrap;
            min-height: 100px;
            padding: 20px;
            background: rgba(255,255,255,0.5);
            border-radius: 15px;
        }

        .letter-tile {
            width: 60px;
            height: 80px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            touch-action: manipulation;
        }

        .letter-tile:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
        }

        .letter-tile:active {
            transform: scale(0.95);
        }

        .letter-tile.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .letter-tile.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .letter-tile.selected {
            animation: selectPulse 0.3s ease;
        }
        
        @keyframes selectPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* æŒ‰éˆ•å€ */
        .button-area {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.2em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .btn-check {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .btn-hint {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
        }

        .btn-reset {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
        }

        .btn-back {
            background: linear-gradient(135deg, #868f96 0%, #596164 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* æç¤ºé¡¯ç¤º */
        .hint-display {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 235, 59, 0.3);
            border-radius: 10px;
            font-size: 1.2em;
            min-height: 50px;
            display: none;
        }

        .hint-display.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        /* æˆç¸¾å–® */
        .result-screen {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .result-screen h2 {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 20px;
        }

        .result-stats {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .stat-item {
            font-size: 1.5em;
            margin: 15px 0;
            padding: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
        }

        /* å›é¥‹è¨Šæ¯ */
        .feedback {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px 50px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            font-size: 1.5em;
            font-weight: bold;
            z-index: 1000;
            display: none;
        }

        .feedback.correct {
            color: #38ef7d;
        }

        .feedback.wrong {
            color: #ff6b6b;
        }

        .feedback.show {
            display: block;
            animation: popIn 0.3s ease;
        }

        /* å‹•ç•« */
        @keyframes popIn {
            0% {
                transform: translate(-50%, -50%) scale(0);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.5s ease;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 600px) {
            .header h1 {
                font-size: 1.8em;
            }

            .chinese-word {
                font-size: 2.5em;
            }

            .letter-slot, .letter-tile {
                width: 50px;
                height: 70px;
                font-size: 1.5em;
            }

            .btn {
                padding: 12px 20px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <!-- æ¨™é¡Œ -->
    <div class="header">
        <h1>ğŸ§© 400å–®å­—æ‹¼åœ–ç‹ (å°å­¸ç‰ˆ)</h1>
        <div class="subtitle">Word Puzzle - çœ‹ä¸­æ–‡,æ‹¼è‹±æ–‡!</div>
    </div>

    <div class="container">
        <!-- å–®å…ƒé¸æ“‡ -->
        <div id="unitSelection" class="unit-selection">
            <div class="unit-card" onclick="startGame(1)">
                <h2>ğŸ¯ å–®å…ƒ 1</h2>
                <p>èª² 1-4</p>
                <p>40å€‹å–®å­—</p>
            </div>
            <div class="unit-card" onclick="startGame(2)">
                <h2>ğŸ¯ å–®å…ƒ 2</h2>
                <p>èª² 5-8</p>
                <p>40å€‹å–®å­—</p>
            </div>
            <div class="unit-card" onclick="startGame(3)">
                <h2>ğŸ¯ å–®å…ƒ 3</h2>
                <p>èª² 9-12</p>
                <p>40å€‹å–®å­—</p>
            </div>
            <div class="unit-card" onclick="startGame(4)">
                <h2>ğŸ¯ å–®å…ƒ 4</h2>
                <p>èª² 13-16</p>
                <p>40å€‹å–®å­—</p>
            </div>
            <div class="unit-card" onclick="startGame(5)">
                <h2>ğŸ¯ å–®å…ƒ 5</h2>
                <p>èª² 17-20</p>
                <p>40å€‹å–®å­—</p>
            </div>
            <div class="unit-card" onclick="startGame(6)">
                <h2>ğŸ¯ å–®å…ƒ 6</h2>
                <p>èª² 21-24</p>
                <p>40å€‹å–®å­—</p>
            </div>
            <div class="unit-card" onclick="startGame(7)">
                <h2>ğŸ¯ å–®å…ƒ 7</h2>
                <p>èª² 25-28</p>
                <p>40å€‹å–®å­—</p>
            </div>
            <div class="unit-card" onclick="startGame(8)">
                <h2>ğŸ¯ å–®å…ƒ 8</h2>
                <p>èª² 29-32</p>
                <p>40å€‹å–®å­—</p>
            </div>
            <div class="unit-card" onclick="startGame(9)">
                <h2>ğŸ¯ å–®å…ƒ 9</h2>
                <p>èª² 33-36</p>
                <p>40å€‹å–®å­—</p>
            </div>
            <div class="unit-card" onclick="startGame(10)">
                <h2>ğŸ¯ å–®å…ƒ 10</h2>
                <p>èª² 37-40</p>
                <p>40å€‹å–®å­—</p>
            </div>
        </div>

        <!-- éŠæˆ²å€ -->
        <div id="gameArea" class="game-area">
            <!-- éŠæˆ²è³‡è¨Š -->
            <div class="game-info">
                <span>ğŸ“ é¡Œæ•¸: <span id="questionNum">1</span>/10</span>
                <span>âœ… ç­”å°: <span id="correctCount">0</span></span>
                <span>ğŸ’¡ æç¤º: <span id="hintCount">0</span></span>
            </div>

            <!-- ä¸­æ–‡æç¤º -->
            <div class="chinese-hint">
                <div class="chinese-hint-label">è«‹æ‹¼å‡ºé€™å€‹å–®å­—:</div>
                <div class="chinese-word" id="chineseWord">è˜‹æœ</div>
                <div class="speaker-icon" onclick="speakWord()">ğŸ”Š</div>
            </div>

            <!-- æç¤ºé¡¯ç¤ºå€ -->
            <div id="hintDisplay" class="hint-display"></div>

            <!-- ç­”æ¡ˆå€ (æ‹–æ”¾ç›®æ¨™) -->
            <div id="answerArea" class="answer-area"></div>

            <!-- å­—æ¯æ±  (æ‹–æ›³ä¾†æº) -->
            <div id="letterPool" class="letter-pool"></div>

            <!-- æŒ‰éˆ•å€ -->
            <div class="button-area">
                <button class="btn btn-check" onclick="checkAnswer()">âœ“ æª¢æŸ¥ç­”æ¡ˆ</button>
                <button class="btn btn-hint" onclick="showHint()">ğŸ’¡ æç¤º</button>
                <button class="btn btn-reset" onclick="resetLetters()">ğŸ”„ é‡ä¾†</button>
                <button class="btn btn-back" onclick="backToMenu()">ğŸ  è¿”å›</button>
            </div>
        </div>

        <!-- æˆç¸¾å–® -->
        <div id="resultScreen" class="result-screen">
            <h2>ğŸ‰ éŠæˆ²çµæŸ!</h2>
            <div class="result-stats">
                <div class="stat-item">ğŸ“ ç¸½é¡Œæ•¸: 10 é¡Œ</div>
                <div class="stat-item">âœ… ç­”å°: <span id="finalCorrect">0</span> é¡Œ</div>
                <div class="stat-item">ğŸ’¡ ä½¿ç”¨æç¤º: <span id="finalHints">0</span> æ¬¡</div>
                <div class="stat-item">ğŸ“Š æ­£ç¢ºç‡: <span id="finalRate">0</span>%</div>
                <div class="stat-item">ğŸ† ç¸½åˆ†: <span id="finalScore">0</span> åˆ†</div>
            </div>
            <div class="button-area">
                <button class="btn btn-check" onclick="restartGame()">ğŸ”„ å†ç©ä¸€æ¬¡</button>
                <button class="btn btn-back" onclick="backToMenu()">ğŸ  è¿”å›é¸å–®</button>
            </div>
        </div>
    </div>

    <!-- å›é¥‹è¨Šæ¯ -->
    <div id="feedback" class="feedback"></div>

    <script>
        // éŠæˆ²è³‡æ–™åº« - 400å€‹å–®å­—,åˆ†æˆ10å€‹å–®å…ƒ
        const vocabulary = {
            1: [ // å–®å…ƒ1: èª²1-4
                {english: 'hello', chinese: 'å“ˆå›‰'},
                {english: 'hi', chinese: 'å—¨'},
                {english: 'good', chinese: 'å¥½çš„'},
                {english: 'morning', chinese: 'æ—©ä¸Š'},
                {english: 'afternoon', chinese: 'ä¸‹åˆ'},
                {english: 'evening', chinese: 'æ™šä¸Š'},
                {english: 'night', chinese: 'å¤œæ™š'},
                {english: 'thank you', chinese: 'è¬è¬'},
                {english: 'you', chinese: 'ä½ '},
                {english: 'welcome', chinese: 'æ­¡è¿'},
                {english: 'I', chinese: 'æˆ‘'},
                {english: 'am', chinese: 'æ˜¯'},
                {english: 'my', chinese: 'æˆ‘çš„'},
                {english: 'name', chinese: 'åå­—'},
                {english: 'is', chinese: 'æ˜¯'},
                {english: 'nice', chinese: 'å¥½çš„'},
                {english: 'to', chinese: 'å»'},
                {english: 'meet', chinese: 'è¦‹é¢'},
                {english: 'too', chinese: 'ä¹Ÿ'},
                {english: 'how', chinese: 'å¦‚ä½•'},
                {english: 'are', chinese: 'æ˜¯'},
                {english: 'fine', chinese: 'å¥½çš„'},
                {english: 'and', chinese: 'å’Œ'},
                {english: 'yes', chinese: 'æ˜¯çš„'},
                {english: 'no', chinese: 'ä¸'},
                {english: 'OK', chinese: 'å¥½çš„'},
                {english: 'bye', chinese: 'å†è¦‹'},
                {english: 'see', chinese: 'çœ‹è¦‹'},
                {english: 'later', chinese: 'ç¨å¾Œ'},
                {english: 'sorry', chinese: 'æŠ±æ­‰'},
                {english: 'excuse', chinese: 'åŸè«’'},
                {english: 'me', chinese: 'æˆ‘'},
                {english: 'please', chinese: 'è«‹'},
                {english: 'here', chinese: 'é€™è£¡'},
                {english: 'this', chinese: 'é€™å€‹'},
                {english: 'that', chinese: 'é‚£å€‹'},
                {english: 'what', chinese: 'ä»€éº¼'},
                {english: 'it', chinese: 'å®ƒ'},
                {english: 'the', chinese: 'é€™å€‹'},
                {english: 'a', chinese: 'ä¸€å€‹'}
            ],
            2: [ // å–®å…ƒ2: èª²5-8
                {english: 'an', chinese: 'ä¸€å€‹'},
                {english: 'book', chinese: 'æ›¸'},
                {english: 'pen', chinese: 'ç­†'},
                {english: 'pencil', chinese: 'é‰›ç­†'},
                {english: 'eraser', chinese: 'æ©¡çš®æ“¦'},
                {english: 'ruler', chinese: 'å°º'},
                {english: 'bag', chinese: 'è¢‹å­'},
                {english: 'desk', chinese: 'æ›¸æ¡Œ'},
                {english: 'chair', chinese: 'æ¤…å­'},
                {english: 'door', chinese: 'é–€'},
                {english: 'window', chinese: 'çª—æˆ¶'},
                {english: 'board', chinese: 'æ¿å­'},
                {english: 'teacher', chinese: 'è€å¸«'},
                {english: 'student', chinese: 'å­¸ç”Ÿ'},
                {english: 'class', chinese: 'ç­ç´š'},
                {english: 'school', chinese: 'å­¸æ ¡'},
                {english: 'one', chinese: 'ä¸€'},
                {english: 'two', chinese: 'äºŒ'},
                {english: 'three', chinese: 'ä¸‰'},
                {english: 'four', chinese: 'å››'},
                {english: 'five', chinese: 'äº”'},
                {english: 'six', chinese: 'å…­'},
                {english: 'seven', chinese: 'ä¸ƒ'},
                {english: 'eight', chinese: 'å…«'},
                {english: 'nine', chinese: 'ä¹'},
                {english: 'ten', chinese: 'å'},
                {english: 'red', chinese: 'ç´…è‰²'},
                {english: 'blue', chinese: 'è—è‰²'},
                {english: 'green', chinese: 'ç¶ è‰²'},
                {english: 'yellow', chinese: 'é»ƒè‰²'},
                {english: 'black', chinese: 'é»‘è‰²'},
                {english: 'white', chinese: 'ç™½è‰²'},
                {english: 'color', chinese: 'é¡è‰²'},
                {english: 'big', chinese: 'å¤§çš„'},
                {english: 'small', chinese: 'å°çš„'},
                {english: 'long', chinese: 'é•·çš„'},
                {english: 'short', chinese: 'çŸ­çš„'},
                {english: 'new', chinese: 'æ–°çš„'},
                {english: 'old', chinese: 'èˆŠçš„'},
                {english: 'cat', chinese: 'è²“'}
            ],
            3: [ // å–®å…ƒ3: èª²9-12
                {english: 'dog', chinese: 'ç‹—'},
                {english: 'bird', chinese: 'é³¥'},
                {english: 'fish', chinese: 'é­š'},
                {english: 'he', chinese: 'ä»–'},
                {english: 'she', chinese: 'å¥¹'},
                {english: 'they', chinese: 'ä»–å€‘'},
                {english: 'we', chinese: 'æˆ‘å€‘'},
                {english: 'boy', chinese: 'ç”·å­©'},
                {english: 'girl', chinese: 'å¥³å­©'},
                {english: 'man', chinese: 'ç”·äºº'},
                {english: 'woman', chinese: 'å¥³äºº'},
                {english: 'family', chinese: 'å®¶åº­'},
                {english: 'father', chinese: 'çˆ¶è¦ª'},
                {english: 'mother', chinese: 'æ¯è¦ª'},
                {english: 'brother', chinese: 'å…„å¼Ÿ'},
                {english: 'sister', chinese: 'å§Šå¦¹'},
                {english: 'happy', chinese: 'å¿«æ¨‚çš„'},
                {english: 'sad', chinese: 'æ‚²å‚·çš„'},
                {english: 'home', chinese: 'å®¶'},
                {english: 'house', chinese: 'æˆ¿å­'},
                {english: 'room', chinese: 'æˆ¿é–“'},
                {english: 'kitchen', chinese: 'å»šæˆ¿'},
                {english: 'bathroom', chinese: 'æµ´å®¤'},
                {english: 'bedroom', chinese: 'è‡¥å®¤'},
                {english: 'living', chinese: 'ç”Ÿæ´»'},
                {english: 'table', chinese: 'æ¡Œå­'},
                {english: 'sofa', chinese: 'æ²™ç™¼'},
                {english: 'bed', chinese: 'åºŠ'},
                {english: 'TV', chinese: 'é›»è¦–'},
                {english: 'phone', chinese: 'é›»è©±'},
                {english: 'computer', chinese: 'é›»è…¦'},
                {english: 'clock', chinese: 'æ™‚é˜'},
                {english: 'time', chinese: 'æ™‚é–“'},
                {english: 'day', chinese: 'å¤©'},
                {english: 'week', chinese: 'é€±'},
                {english: 'month', chinese: 'æœˆ'},
                {english: 'year', chinese: 'å¹´'},
                {english: 'today', chinese: 'ä»Šå¤©'},
                {english: 'Monday', chinese: 'æ˜ŸæœŸä¸€'},
                {english: 'Tuesday', chinese: 'æ˜ŸæœŸäºŒ'}
            ],
            4: [ // å–®å…ƒ4: èª²13-16
                {english: 'Wednesday', chinese: 'æ˜ŸæœŸä¸‰'},
                {english: 'Thursday', chinese: 'æ˜ŸæœŸå››'},
                {english: 'Friday', chinese: 'æ˜ŸæœŸäº”'},
                {english: 'Saturday', chinese: 'æ˜ŸæœŸå…­'},
                {english: 'Sunday', chinese: 'æ˜ŸæœŸæ—¥'},
                {english: 'eat', chinese: 'åƒ'},
                {english: 'drink', chinese: 'å–'},
                {english: 'breakfast', chinese: 'æ—©é¤'},
                {english: 'lunch', chinese: 'åˆé¤'},
                {english: 'dinner', chinese: 'æ™šé¤'},
                {english: 'food', chinese: 'é£Ÿç‰©'},
                {english: 'rice', chinese: 'ç±³é£¯'},
                {english: 'bread', chinese: 'éºµåŒ…'},
                {english: 'egg', chinese: 'è›‹'},
                {english: 'milk', chinese: 'ç‰›å¥¶'},
                {english: 'water', chinese: 'æ°´'},
                {english: 'tea', chinese: 'èŒ¶'},
                {english: 'juice', chinese: 'æœæ±'},
                {english: 'apple', chinese: 'è˜‹æœ'},
                {english: 'banana', chinese: 'é¦™è•‰'},
                {english: 'orange', chinese: 'æ©˜å­'},
                {english: 'fruit', chinese: 'æ°´æœ'},
                {english: 'like', chinese: 'å–œæ­¡'},
                {english: 'love', chinese: 'æ„›'},
                {english: 'want', chinese: 'æƒ³è¦'},
                {english: 'need', chinese: 'éœ€è¦'},
                {english: 'have', chinese: 'æœ‰'},
                {english: 'get', chinese: 'å¾—åˆ°'},
                {english: 'give', chinese: 'çµ¦'},
                {english: 'take', chinese: 'æ‹¿'},
                {english: 'make', chinese: 'åš'},
                {english: 'do', chinese: 'åš'},
                {english: 'go', chinese: 'å»'},
                {english: 'come', chinese: 'ä¾†'},
                {english: 'walk', chinese: 'èµ°'},
                {english: 'run', chinese: 'è·‘'},
                {english: 'jump', chinese: 'è·³'},
                {english: 'sit', chinese: 'å'},
                {english: 'stand', chinese: 'ç«™'},
                {english: 'sleep', chinese: 'ç¡è¦º'}
            ],
            5: [ // å–®å…ƒ5: èª²17-20
                {english: 'wake', chinese: 'é†’ä¾†'},
                {english: 'wash', chinese: 'æ´—'},
                {english: 'brush', chinese: 'åˆ·'},
                {english: 'wear', chinese: 'ç©¿'},
                {english: 'clothes', chinese: 'è¡£æœ'},
                {english: 'shirt', chinese: 'è¥¯è¡«'},
                {english: 'pants', chinese: 'è¤²å­'},
                {english: 'shoes', chinese: 'é‹å­'},
                {english: 'hat', chinese: 'å¸½å­'},
                {english: 'coat', chinese: 'å¤–å¥—'},
                {english: 'hot', chinese: 'ç†±çš„'},
                {english: 'cold', chinese: 'å†·çš„'},
                {english: 'warm', chinese: 'æº«æš–çš„'},
                {english: 'cool', chinese: 'æ¶¼çˆ½çš„'},
                {english: 'weather', chinese: 'å¤©æ°£'},
                {english: 'sunny', chinese: 'æ™´æœ—çš„'},
                {english: 'rainy', chinese: 'ä¸‹é›¨çš„'},
                {english: 'cloudy', chinese: 'å¤šé›²çš„'},
                {english: 'windy', chinese: 'æœ‰é¢¨çš„'},
                {english: 'spring', chinese: 'æ˜¥å¤©'},
                {english: 'summer', chinese: 'å¤å¤©'},
                {english: 'fall', chinese: 'ç§‹å¤©'},
                {english: 'winter', chinese: 'å†¬å¤©'},
                {english: 'beautiful', chinese: 'ç¾éº—çš„'},
                {english: 'pretty', chinese: 'æ¼‚äº®çš„'},
                {english: 'tall', chinese: 'é«˜çš„'},
                {english: 'short', chinese: 'çŸ®çš„'},
                {english: 'fat', chinese: 'èƒ–çš„'},
                {english: 'thin', chinese: 'ç˜¦çš„'},
                {english: 'strong', chinese: 'å¼·å£¯çš„'},
                {english: 'weak', chinese: 'è™›å¼±çš„'},
                {english: 'fast', chinese: 'å¿«çš„'},
                {english: 'slow', chinese: 'æ…¢çš„'},
                {english: 'easy', chinese: 'å®¹æ˜“çš„'},
                {english: 'hard', chinese: 'å›°é›£çš„'},
                {english: 'right', chinese: 'å°çš„'},
                {english: 'wrong', chinese: 'éŒ¯çš„'},
                {english: 'good', chinese: 'å¥½çš„'},
                {english: 'bad', chinese: 'å£çš„'},
                {english: 'friend', chinese: 'æœ‹å‹'}
            ],
            6: [ // å–®å…ƒ6: èª²21-24
                {english: 'people', chinese: 'äººå€‘'},
                {english: 'everyone', chinese: 'æ¯å€‹äºº'},
                {english: 'someone', chinese: 'æŸäºº'},
                {english: 'nobody', chinese: 'æ²’æœ‰äºº'},
                {english: 'help', chinese: 'å¹«åŠ©'},
                {english: 'thank', chinese: 'æ„Ÿè¬'},
                {english: 'kind', chinese: 'å‹å–„çš„'},
                {english: 'smart', chinese: 'è°æ˜çš„'},
                {english: 'funny', chinese: 'æœ‰è¶£çš„'},
                {english: 'play', chinese: 'ç©'},
                {english: 'game', chinese: 'éŠæˆ²'},
                {english: 'ball', chinese: 'çƒ'},
                {english: 'toy', chinese: 'ç©å…·'},
                {english: 'music', chinese: 'éŸ³æ¨‚'},
                {english: 'sing', chinese: 'å”±æ­Œ'},
                {english: 'dance', chinese: 'è·³èˆ'},
                {english: 'movie', chinese: 'é›»å½±'},
                {english: 'watch', chinese: 'è§€çœ‹'},
                {english: 'read', chinese: 'é–±è®€'},
                {english: 'write', chinese: 'å¯«'},
                {english: 'draw', chinese: 'ç•«'},
                {english: 'study', chinese: 'å­¸ç¿’'},
                {english: 'learn', chinese: 'å­¸ç¿’'},
                {english: 'know', chinese: 'çŸ¥é“'},
                {english: 'think', chinese: 'æƒ³'},
                {english: 'understand', chinese: 'ç†è§£'},
                {english: 'remember', chinese: 'è¨˜å¾—'},
                {english: 'forget', chinese: 'å¿˜è¨˜'},
                {english: 'talk', chinese: 'èªªè©±'},
                {english: 'speak', chinese: 'è¬›'},
                {english: 'tell', chinese: 'å‘Šè¨´'},
                {english: 'ask', chinese: 'å•'},
                {english: 'answer', chinese: 'å›ç­”'},
                {english: 'listen', chinese: 'è½'},
                {english: 'hear', chinese: 'è½åˆ°'},
                {english: 'look', chinese: 'çœ‹'},
                {english: 'see', chinese: 'çœ‹è¦‹'},
                {english: 'find', chinese: 'æ‰¾åˆ°'},
                {english: 'lose', chinese: 'å¤±å»'},
                {english: 'open', chinese: 'æ‰“é–‹'}
            ],
            7: [ // å–®å…ƒ7: èª²25-28
                {english: 'close', chinese: 'é—œé–‰'},
                {english: 'start', chinese: 'é–‹å§‹'},
                {english: 'stop', chinese: 'åœæ­¢'},
                {english: 'finish', chinese: 'å®Œæˆ'},
                {english: 'wait', chinese: 'ç­‰å¾…'},
                {english: 'arrive', chinese: 'åˆ°é”'},
                {english: 'leave', chinese: 'é›¢é–‹'},
                {english: 'stay', chinese: 'åœç•™'},
                {english: 'travel', chinese: 'æ—…è¡Œ'},
                {english: 'visit', chinese: 'åƒè§€'},
                {english: 'country', chinese: 'åœ‹å®¶'},
                {english: 'city', chinese: 'åŸå¸‚'},
                {english: 'street', chinese: 'è¡—é“'},
                {english: 'park', chinese: 'å…¬åœ’'},
                {english: 'store', chinese: 'å•†åº—'},
                {english: 'restaurant', chinese: 'é¤å»³'},
                {english: 'hospital', chinese: 'é†«é™¢'},
                {english: 'bank', chinese: 'éŠ€è¡Œ'},
                {english: 'post', chinese: 'éƒµå±€'},
                {english: 'office', chinese: 'è¾¦å…¬å®¤'},
                {english: 'library', chinese: 'åœ–æ›¸é¤¨'},
                {english: 'museum', chinese: 'åšç‰©é¤¨'},
                {english: 'station', chinese: 'è»Šç«™'},
                {english: 'airport', chinese: 'æ©Ÿå ´'},
                {english: 'bus', chinese: 'å…¬è»Š'},
                {english: 'train', chinese: 'ç«è»Š'},
                {english: 'car', chinese: 'æ±½è»Š'},
                {english: 'bike', chinese: 'è…³è¸è»Š'},
                {english: 'plane', chinese: 'é£›æ©Ÿ'},
                {english: 'ship', chinese: 'èˆ¹'},
                {english: 'drive', chinese: 'é–‹è»Š'},
                {english: 'ride', chinese: 'é¨'},
                {english: 'fly', chinese: 'é£›'},
                {english: 'turn', chinese: 'è½‰'},
                {english: 'left', chinese: 'å·¦é‚Š'},
                {english: 'right', chinese: 'å³é‚Š'},
                {english: 'up', chinese: 'ä¸Š'},
                {english: 'down', chinese: 'ä¸‹'},
                {english: 'front', chinese: 'å‰é¢'},
                {english: 'back', chinese: 'å¾Œé¢'}
            ],
            8: [ // å–®å…ƒ8: èª²29-32
                {english: 'near', chinese: 'é™„è¿‘'},
                {english: 'far', chinese: 'é çš„'},
                {english: 'next', chinese: 'ä¸‹ä¸€å€‹'},
                {english: 'between', chinese: 'ä¹‹é–“'},
                {english: 'money', chinese: 'éŒ¢'},
                {english: 'buy', chinese: 'è²·'},
                {english: 'sell', chinese: 'è³£'},
                {english: 'price', chinese: 'åƒ¹æ ¼'},
                {english: 'cheap', chinese: 'ä¾¿å®œçš„'},
                {english: 'expensive', chinese: 'æ˜‚è²´çš„'},
                {english: 'free', chinese: 'å…è²»çš„'},
                {english: 'pay', chinese: 'ä»˜éŒ¢'},
                {english: 'cost', chinese: 'èŠ±è²»'},
                {english: 'save', chinese: 'å„²è“„'},
                {english: 'spend', chinese: 'èŠ±è²»'},
                {english: 'rich', chinese: 'å¯Œæœ‰çš„'},
                {english: 'poor', chinese: 'è²§çª®çš„'},
                {english: 'job', chinese: 'å·¥ä½œ'},
                {english: 'work', chinese: 'å·¥ä½œ'},
                {english: 'worker', chinese: 'å·¥äºº'},
                {english: 'doctor', chinese: 'é†«ç”Ÿ'},
                {english: 'nurse', chinese: 'è­·å£«'},
                {english: 'police', chinese: 'è­¦å¯Ÿ'},
                {english: 'cook', chinese: 'å»šå¸«'},
                {english: 'farmer', chinese: 'è¾²å¤«'},
                {english: 'engineer', chinese: 'å·¥ç¨‹å¸«'},
                {english: 'artist', chinese: 'è—è¡“å®¶'},
                {english: 'singer', chinese: 'æ­Œæ‰‹'},
                {english: 'actor', chinese: 'æ¼”å“¡'},
                {english: 'writer', chinese: 'ä½œå®¶'},
                {english: 'busy', chinese: 'å¿™ç¢Œçš„'},
                {english: 'tired', chinese: 'ç–²å€¦çš„'},
                {english: 'sick', chinese: 'ç”Ÿç—…çš„'},
                {english: 'healthy', chinese: 'å¥åº·çš„'},
                {english: 'feel', chinese: 'æ„Ÿè¦º'},
                {english: 'hurt', chinese: 'å—å‚·'},
                {english: 'pain', chinese: 'ç–¼ç—›'},
                {english: 'medicine', chinese: 'è—¥'},
                {english: 'rest', chinese: 'ä¼‘æ¯'},
                {english: 'better', chinese: 'æ›´å¥½çš„'}
            ],
            9: [ // å–®å…ƒ9: èª²33-36
                {english: 'worse', chinese: 'æ›´ç³Ÿçš„'},
                {english: 'care', chinese: 'ç…§é¡§'},
                {english: 'check', chinese: 'æª¢æŸ¥'},
                {english: 'body', chinese: 'èº«é«”'},
                {english: 'head', chinese: 'é ­'},
                {english: 'face', chinese: 'è‡‰'},
                {english: 'eye', chinese: 'çœ¼ç›'},
                {english: 'ear', chinese: 'è€³æœµ'},
                {english: 'nose', chinese: 'é¼»å­'},
                {english: 'mouth', chinese: 'å˜´å·´'},
                {english: 'tooth', chinese: 'ç‰™é½’'},
                {english: 'hand', chinese: 'æ‰‹'},
                {english: 'foot', chinese: 'è…³'},
                {english: 'leg', chinese: 'è…¿'},
                {english: 'arm', chinese: 'æ‰‹è‡‚'},
                {english: 'finger', chinese: 'æ‰‹æŒ‡'},
                {english: 'hair', chinese: 'é ­é«®'},
                {english: 'exercise', chinese: 'é‹å‹•'},
                {english: 'sport', chinese: 'é‹å‹•'},
                {english: 'swim', chinese: 'æ¸¸æ³³'},
                {english: 'basketball', chinese: 'ç±ƒçƒ'},
                {english: 'baseball', chinese: 'æ£’çƒ'},
                {english: 'soccer', chinese: 'è¶³çƒ'},
                {english: 'tennis', chinese: 'ç¶²çƒ'},
                {english: 'player', chinese: 'é¸æ‰‹'},
                {english: 'win', chinese: 'è´'},
                {english: 'lose', chinese: 'è¼¸'},
                {english: 'team', chinese: 'éšŠä¼'},
                {english: 'member', chinese: 'æˆå“¡'},
                {english: 'hobby', chinese: 'å—œå¥½'},
                {english: 'interest', chinese: 'èˆˆè¶£'},
                {english: 'enjoy', chinese: 'äº«å—'},
                {english: 'fun', chinese: 'æœ‰è¶£çš„'},
                {english: 'boring', chinese: 'ç„¡èŠçš„'},
                {english: 'exciting', chinese: 'ä»¤äººèˆˆå¥®çš„'},
                {english: 'interesting', chinese: 'æœ‰è¶£çš„'},
                {english: 'important', chinese: 'é‡è¦çš„'},
                {english: 'special', chinese: 'ç‰¹åˆ¥çš„'},
                {english: 'different', chinese: 'ä¸åŒçš„'},
                {english: 'same', chinese: 'ç›¸åŒçš„'}
            ],
            10: [ // å–®å…ƒ10: èª²37-40
                {english: 'another', chinese: 'å¦ä¸€å€‹'},
                {english: 'other', chinese: 'å…¶ä»–çš„'},
                {english: 'all', chinese: 'å…¨éƒ¨'},
                {english: 'some', chinese: 'ä¸€äº›'},
                {english: 'many', chinese: 'è¨±å¤š'},
                {english: 'much', chinese: 'å¾ˆå¤š'},
                {english: 'few', chinese: 'å°‘æ•¸'},
                {english: 'little', chinese: 'å°‘è¨±'},
                {english: 'more', chinese: 'æ›´å¤š'},
                {english: 'less', chinese: 'æ›´å°‘'},
                {english: 'most', chinese: 'æœ€å¤š'},
                {english: 'enough', chinese: 'è¶³å¤ çš„'},
                {english: 'very', chinese: 'éå¸¸'},
                {english: 'really', chinese: 'çœŸçš„'},
                {english: 'quite', chinese: 'ç›¸ç•¶'},
                {english: 'too', chinese: 'å¤ª'},
                {english: 'so', chinese: 'å¦‚æ­¤'},
                {english: 'well', chinese: 'å¥½åœ°'},
                {english: 'better', chinese: 'æ›´å¥½'},
                {english: 'best', chinese: 'æœ€å¥½'},
                {english: 'always', chinese: 'ç¸½æ˜¯'},
                {english: 'usually', chinese: 'é€šå¸¸'},
                {english: 'often', chinese: 'ç¶“å¸¸'},
                {english: 'sometimes', chinese: 'æœ‰æ™‚'},
                {english: 'never', chinese: 'å¾ä¸'},
                {english: 'maybe', chinese: 'ä¹Ÿè¨±'},
                {english: 'sure', chinese: 'ç¢ºå®š'},
                {english: 'of', chinese: 'çš„'},
                {english: 'course', chinese: 'ç•¶ç„¶'},
                {english: 'problem', chinese: 'å•é¡Œ'},
                {english: 'question', chinese: 'å•é¡Œ'},
                {english: 'idea', chinese: 'ä¸»æ„'},
                {english: 'plan', chinese: 'è¨ˆåŠƒ'},
                {english: 'try', chinese: 'å˜—è©¦'},
                {english: 'use', chinese: 'ä½¿ç”¨'},
                {english: 'practice', chinese: 'ç·´ç¿’'},
                {english: 'difficult', chinese: 'å›°é›£çš„'},
                {english: 'simple', chinese: 'ç°¡å–®çš„'},
                {english: 'possible', chinese: 'å¯èƒ½çš„'},
                {english: 'impossible', chinese: 'ä¸å¯èƒ½çš„'}
            ]
        };

        // éŠæˆ²ç‹€æ…‹
        let currentUnit = 1;
        let currentQuestion = 0;
        let currentWord = null;
        let correctAnswers = 0;
        let hintUsed = 0;
        let questions = [];
        let userAnswer = [];

        // é–‹å§‹éŠæˆ²
        function startGame(unit) {
            currentUnit = unit;
            currentQuestion = 0;
            correctAnswers = 0;
            hintUsed = 0;

            // éš¨æ©Ÿé¸10é¡Œ
            const unitWords = vocabulary[unit];
            questions = [];
            const usedIndices = new Set();

            while (questions.length < 10) {
                const randomIndex = Math.floor(Math.random() * unitWords.length);
                if (!usedIndices.has(randomIndex)) {
                    usedIndices.add(randomIndex);
                    questions.push({...unitWords[randomIndex]});
                }
            }

            // åˆ‡æ›ç•«é¢
            document.getElementById('unitSelection').style.display = 'none';
            document.getElementById('gameArea').style.display = 'block';
            document.getElementById('resultScreen').style.display = 'none';

            loadQuestion();
        }

        // è¼‰å…¥é¡Œç›®
        function loadQuestion() {
            if (currentQuestion >= 10) {
                showResult();
                return;
            }

            currentWord = questions[currentQuestion];
            userAnswer = [];

            // æ›´æ–°è³‡è¨Š
            document.getElementById('questionNum').textContent = currentQuestion + 1;
            document.getElementById('correctCount').textContent = correctAnswers;
            document.getElementById('hintCount').textContent = hintUsed;

            // é¡¯ç¤ºä¸­æ–‡
            document.getElementById('chineseWord').textContent = currentWord.chinese;

            // éš±è—æç¤º
            document.getElementById('hintDisplay').classList.remove('show');

            // å‰µå»ºç­”æ¡ˆæ ¼å­
            createAnswerSlots();

            // å‰µå»ºå­—æ¯æ± 
            createLetterPool();

            // è‡ªå‹•æœ—è®€
            setTimeout(() => speakWord(), 500);
        }

        // å‰µå»ºç­”æ¡ˆæ ¼å­
        function createAnswerSlots() {
            const answerArea = document.getElementById('answerArea');
            answerArea.innerHTML = '';

            const letters = currentWord.english.split('');
            letters.forEach((letter, index) => {
                const slot = document.createElement('div');
                slot.className = 'letter-slot';
                slot.dataset.index = index;
                slot.dataset.correctLetter = letter;
                
                // å¦‚æœæ˜¯ç©ºæ ¼,é¡¯ç¤ºè¼ƒå°çš„é–“éš”
                if (letter === ' ') {
                    slot.style.width = '30px';
                    slot.style.border = 'none';
                    slot.style.background = 'transparent';
                    slot.classList.add('filled'); // ç©ºæ ¼è¦–ç‚ºå·²å¡«
                    slot.textContent = ' ';
                }

                answerArea.appendChild(slot);
            });
        }

        // å‰µå»ºå­—æ¯æ± 
        function createLetterPool() {
            const letterPool = document.getElementById('letterPool');
            letterPool.innerHTML = '';

            // å°‡å–®å­—æ‹†æˆå­—æ¯ä¸¦æ‰“äº‚(æ’é™¤ç©ºæ ¼)
            const letters = currentWord.english.split('').filter(l => l !== ' ');
            const shuffled = shuffleArray([...letters]);

            shuffled.forEach((letter, index) => {
                const tile = document.createElement('div');
                tile.className = 'letter-tile';
                tile.textContent = letter;
                tile.dataset.letter = letter;
                tile.dataset.id = index;

                // é»æ“Šäº‹ä»¶
                tile.addEventListener('click', handleLetterClick);

                letterPool.appendChild(tile);
            });
        }

        // è™•ç†å­—æ¯é»æ“Š
        function handleLetterClick(e) {
            const tile = e.target;
            const letter = tile.dataset.letter;
            
            // æ‰¾åˆ°ç¬¬ä¸€å€‹ç©ºçš„æ ¼å­(è·³éå·²å¡«å……å’Œå·²æ­£ç¢ºçš„æ ¼å­)
            const slots = document.querySelectorAll('.letter-slot');
            let placed = false;
            
            for (let slot of slots) {
                // è·³éç©ºæ ¼ã€å·²æ­£ç¢ºçš„æ ¼å­ã€å·²å¡«å……çš„æ ¼å­
                if (slot.dataset.correctLetter === ' ') continue;
                if (slot.classList.contains('correct')) continue;
                if (slot.classList.contains('filled') && !slot.classList.contains('wrong')) continue;
                
                // å¦‚æœæ ¼å­æ˜¯ç©ºçš„,æˆ–è€…åªæ˜¯è¢«æ¨™è¨˜ç‚ºwrong(å·²è¢«æ¸…ç©º),å‰‡å¯ä»¥å¡«å…¥
                if (!slot.textContent || slot.textContent === '') {
                    // æ”¾ç½®å­—æ¯
                    const index = parseInt(slot.dataset.index);
                    slot.textContent = letter;
                    slot.classList.remove('wrong'); // ç§»é™¤éŒ¯èª¤æ¨™è¨˜
                    slot.classList.add('filled');
                    slot.dataset.tileId = tile.dataset.id; // è¨˜éŒ„æ˜¯å“ªå€‹å­—æ¯ç£š
                    userAnswer[index] = letter;
                    
                    // éš±è—å­—æ¯ç£šä¸¦æ·»åŠ å‹•ç•«
                    tile.classList.add('selected');
                    setTimeout(() => {
                        tile.classList.add('hidden');
                    }, 300);
                    
                    placed = true;
                    break;
                }
            }
            
            // å¦‚æœæ‰€æœ‰æ ¼å­éƒ½å¡«æ»¿äº†,è‡ªå‹•æª¢æŸ¥ç­”æ¡ˆ
            if (placed && checkIfAllFilled()) {
                setTimeout(() => {
                    checkAnswer();
                }, 500);
            }
        }

        // æª¢æŸ¥æ˜¯å¦å…¨éƒ¨å¡«æ»¿
        function checkIfAllFilled() {
            const slots = document.querySelectorAll('.letter-slot');
            for (let slot of slots) {
                // è·³éç©ºæ ¼
                if (slot.dataset.correctLetter === ' ') continue;
                // è·³éå·²ç¶“æ­£ç¢ºçš„æ ¼å­
                if (slot.classList.contains('correct')) continue;
                // æª¢æŸ¥æ˜¯å¦é‚„æœ‰ç©ºæ ¼å­
                if (!slot.textContent || slot.textContent === '') {
                    return false;
                }
            }
            return true;
        }

        // æ‰“äº‚é™£åˆ—
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // æª¢æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            const correct = currentWord.english;
            const slots = document.querySelectorAll('.letter-slot');
            
            let allCorrect = true;
            let hasWrong = false;
            
            // æª¢æŸ¥æ¯å€‹å­—æ¯
            slots.forEach((slot, index) => {
                const correctLetter = slot.dataset.correctLetter;
                const userLetter = slot.textContent;
                
                // è·³éç©ºæ ¼
                if (correctLetter === ' ') return;
                
                if (userLetter === correctLetter) {
                    // æ­£ç¢ºçš„å­—æ¯æ¨™è¨˜ç‚ºç¶ è‰²
                    slot.classList.remove('filled', 'wrong');
                    slot.classList.add('correct');
                } else {
                    // éŒ¯èª¤çš„å­—æ¯æ¨™è¨˜ç‚ºç´…è‰²
                    slot.classList.remove('filled', 'correct');
                    slot.classList.add('wrong');
                    allCorrect = false;
                    hasWrong = true;
                }
            });

            if (allCorrect) {
                // å…¨éƒ¨ç­”å°
                correctAnswers++;
                playSuccessSound();
                showFeedback('âœ… å¤ªæ£’äº†!å®Œå…¨æ­£ç¢º!', 'correct');
                speakWord();

                setTimeout(() => {
                    currentQuestion++;
                    loadQuestion();
                }, 2000);
            } else {
                // æœ‰éŒ¯èª¤
                playErrorSound();
                showFeedback('ğŸ’¡ ç´…è‰²çš„å­—æ¯æ˜¯éŒ¯çš„,è«‹é‡æ–°é¸æ“‡!', 'wrong');
                
                // 3.5ç§’å¾Œæ¸…ç©ºéŒ¯èª¤çš„å­—æ¯ (å»¶é•·2ç§’è®“å°å­¸ç”Ÿçœ‹æ¸…æ¥š)
                setTimeout(() => {
                    clearWrongLetters();
                }, 3500);
            }
        }

        // æ¸…ç©ºéŒ¯èª¤çš„å­—æ¯,ä¿ç•™æ­£ç¢ºçš„
        function clearWrongLetters() {
            const slots = document.querySelectorAll('.letter-slot');
            const tiles = document.querySelectorAll('.letter-tile');
            
            slots.forEach((slot, index) => {
                if (slot.classList.contains('wrong')) {
                    const tileId = slot.dataset.tileId;
                    
                    // æ¸…ç©ºæ ¼å­
                    slot.textContent = '';
                    slot.classList.remove('wrong', 'filled');
                    delete slot.dataset.tileId;
                    userAnswer[index] = undefined;
                    
                    // æ ¹æ“štileIdæ¢å¾©å°æ‡‰çš„å­—æ¯ç£š
                    if (tileId !== undefined) {
                        tiles.forEach(tile => {
                            if (tile.dataset.id === tileId) {
                                tile.classList.remove('hidden');
                            }
                        });
                    }
                }
            });
        }

        // é¡¯ç¤ºæç¤º
        function showHint() {
            hintUsed++;
            document.getElementById('hintCount').textContent = hintUsed;

            const hintDisplay = document.getElementById('hintDisplay');
            const word = currentWord.english;

            // æç¤º1: é¦–å­—æ¯
            if (hintUsed % 3 === 1) {
                hintDisplay.textContent = `ğŸ’¡ æç¤º: é¦–å­—æ¯æ˜¯ "${word[0].toUpperCase()}"`;
            }
            // æç¤º2: å–®å­—é•·åº¦
            else if (hintUsed % 3 === 2) {
                const length = word.replace(/ /g, '').length;
                hintDisplay.textContent = `ğŸ’¡ æç¤º: é€™å€‹å–®å­—æœ‰ ${length} å€‹å­—æ¯`;
            }
            // æç¤º3: æœ—è®€
            else {
                hintDisplay.textContent = `ğŸ’¡ æç¤º: ä»”ç´°è½ç™¼éŸ³ ğŸ”Š`;
                speakWord();
            }

            hintDisplay.classList.add('show');
        }

        // é‡ç½®å­—æ¯
        function resetLetters() {
            const slots = document.querySelectorAll('.letter-slot');
            const tiles = document.querySelectorAll('.letter-tile');
            
            // æ¸…ç©ºæ‰€æœ‰éæ­£ç¢ºçš„æ ¼å­
            slots.forEach((slot, index) => {
                if (!slot.classList.contains('correct') && slot.dataset.correctLetter !== ' ') {
                    slot.textContent = '';
                    slot.classList.remove('filled', 'wrong');
                    userAnswer[index] = undefined;
                }
            });

            // é¡¯ç¤ºæ‰€æœ‰å­—æ¯
            tiles.forEach(tile => tile.classList.remove('hidden'));
        }

        // èªéŸ³æœ—è®€
        function speakWord() {
            if ('speechSynthesis' in window && currentWord) {
                window.speechSynthesis.cancel();

                const utterance = new SpeechSynthesisUtterance(currentWord.english);
                utterance.lang = 'en-US';
                utterance.rate = 0.85;
                utterance.pitch = 1;
                utterance.volume = 1;

                window.speechSynthesis.speak(utterance);
            }
        }

        // éŸ³æ•ˆç³»çµ±
        function playSuccessSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.frequency.value = 523.25;
            oscillator.type = 'sine';

            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        function playErrorSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.frequency.value = 200;
            oscillator.type = 'sawtooth';

            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        // é¡¯ç¤ºå›é¥‹
        function showFeedback(message, type) {
            const feedback = document.getElementById('feedback');
            feedback.textContent = message;
            feedback.className = `feedback ${type} show`;

            // éŒ¯èª¤è¨Šæ¯é¡¯ç¤º3ç§’,ç­”å°è¨Šæ¯é¡¯ç¤º1.5ç§’
            const duration = type === 'wrong' ? 3000 : 1500;
            setTimeout(() => {
                feedback.classList.remove('show');
            }, duration);
        }

        // é¡¯ç¤ºæˆç¸¾
        function showResult() {
            const rate = Math.round((correctAnswers / 10) * 100);
            const score = correctAnswers * 10;

            document.getElementById('finalCorrect').textContent = correctAnswers;
            document.getElementById('finalHints').textContent = hintUsed;
            document.getElementById('finalRate').textContent = rate;
            document.getElementById('finalScore').textContent = score;

            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'block';
        }

        // é‡æ–°é–‹å§‹
        function restartGame() {
            startGame(currentUnit);
        }

        // è¿”å›é¸å–®
        function backToMenu() {
            document.getElementById('unitSelection').style.display = 'grid';
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'none';
        }
    </script>
</body>
</html>
