<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>400å–®å­—é…å°å¤§æŒ‘æˆ°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            overflow: hidden;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            max-height: 98vh;
            overflow-y: auto;
        }

        /* é¦–é  */
        .home-screen {
            text-align: center;
            background: white;
            padding: 30px 25px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .title {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .subtitle {
            font-size: 1.1em;
            color: #666;
            margin-bottom: 30px;
        }

        .difficulty-selector {
            display: none;
            margin-top: 25px;
        }

        .difficulty-selector.show {
            display: block;
        }

        .difficulty-selector h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .difficulty-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .difficulty-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 130px;
        }

        .difficulty-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .difficulty-btn:active {
            transform: translateY(-1px);
        }

        .start-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px 45px;
            border: none;
            border-radius: 12px;
            font-size: 1.3em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .start-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .start-btn:active {
            transform: translateY(-2px);
        }

        .hint {
            margin-top: 15px;
            color: #666;
            font-size: 0.95em;
        }

        /* éŠæˆ²ç•«é¢ */
        .game-screen {
            display: none;
            background: white;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .game-screen.active {
            display: block;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .timer, .score {
            font-size: 0.95em;
            color: #667eea;
            font-weight: bold;
        }

        .cards-grid {
            display: grid;
            gap: 6px;
            margin-top: 8px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .card {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            user-select: none;
            padding: 8px;
        }

        .card:hover {
            transform: scale(1.05);
        }

        .card:active {
            transform: scale(0.95);
        }

        .card.flipped {
            background: white;
            color: #333;
            border: 3px solid #667eea;
        }

        .card.matched {
            background: #4caf50;
            color: white;
            animation: matchPulse 0.5s ease;
            cursor: default;
        }

        .card.wrong {
            background: #f44336;
            animation: wrongShake 0.5s ease;
        }

        @keyframes matchPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* çµæœç•«é¢ */
        .result-screen {
            display: none;
            text-align: center;
            background: white;
            padding: 30px 25px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .result-screen.active {
            display: block;
        }

        .result-screen h2 {
            font-size: 2em;
            color: #667eea;
            margin-bottom: 20px;
        }

        .result-stats {
            font-size: 1.3em;
            margin: 20px 0;
            line-height: 1.8;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 10px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #667eea;
            padding: 8px 20px;
            font-size: 0.95em;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .title {
                font-size: 2em;
            }
            
            .start-btn {
                padding: 15px 35px;
                font-size: 1.2em;
            }

            .cards-grid {
                max-width: 600px;
            }

            .card {
                font-size: 1.1em;
            }

            .game-screen {
                padding: 8px;
            }

            .timer, .score {
                font-size: 0.85em;
            }
        }

        @media (max-width: 480px) {
            .title {
                font-size: 1.6em;
            }

            .cards-grid {
                max-width: 450px;
                gap: 5px;
            }

            .card {
                font-size: 1em;
                border-radius: 6px;
                padding: 6px;
            }

            .game-header {
                gap: 4px;
            }

            .game-screen {
                padding: 6px;
            }

            .timer, .score {
                font-size: 0.75em;
            }

            .btn-secondary {
                padding: 5px 12px;
                font-size: 0.75em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¦–é  -->
        <div id="homeScreen" class="home-screen">
            <h1 class="title">
                ğŸ® 400å–®å­—é…å°å¤§æŒ‘æˆ°
            </h1>
            <p class="subtitle">
                ğŸ¯ ç¿»é–‹å¡ç‰‡,é…å°è‹±æ–‡å’Œä¸­æ–‡!<br>
                è¨“ç·´è¨˜æ†¶åŠ›,å­¸ç¿’æ›´æœ‰è¶£!
            </p>
            
            <button class="start-btn" id="startBtn">ğŸš€ é–‹å§‹éŠæˆ²</button>

            <!-- é›£åº¦é¸æ“‡ -->
            <div class="difficulty-selector" id="difficultySelector">
                <h3>ğŸ¯ é¸æ“‡é›£åº¦</h3>
                <div class="difficulty-buttons">
                    <button class="difficulty-btn" data-size="4x4">
                        ğŸ˜Š ç°¡å–®<br>
                        <span style="font-size: 0.7em;">(4x4 = 16å¼µ)</span>
                    </button>
                    <button class="difficulty-btn" data-size="4x6">
                        ğŸ¤” ä¸­ç­‰<br>
                        <span style="font-size: 0.7em;">(4x6 = 24å¼µ)</span>
                    </button>
                </div>
            </div>

            <p class="hint">ğŸ’¡ æç¤º:ç¿»é–‹å…©å¼µç‰Œ,é…å°æˆåŠŸç¹¼çºŒæŒ‘æˆ°!</p>
        </div>

        <!-- éŠæˆ²ç•«é¢ -->
        <div id="gameScreen" class="game-screen">
            <div class="game-header">
                <div class="timer" id="timer">â±ï¸ 0:00</div>
                <div class="score" id="score">é…å°: 0/8</div>
                <button class="btn btn-secondary" id="backBtn">ğŸ  è¿”å›</button>
            </div>

            <div class="cards-grid" id="cardsGrid"></div>
        </div>

        <!-- çµæœç•«é¢ -->
        <div id="resultScreen" class="result-screen">
            <h2>ğŸ‰ éŠæˆ²çµæŸ!</h2>
            <div class="result-stats" id="resultStats"></div>
            <div>
                <button class="btn" id="playAgainBtn">ğŸ”„ å†ç©ä¸€æ¬¡</button>
                <button class="btn btn-secondary" id="homeBtn">ğŸ  å›é¦–é </button>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // å–®å­—è³‡æ–™åº« (100å€‹å¸¸ç”¨å–®å­—)
        // ==========================================
        
        const VOCABULARY = [
            { english: "I", chinese: "æˆ‘" },
            { english: "you", chinese: "ä½ ;ä½ å€‘" },
            { english: "he", chinese: "ä»–" },
            { english: "she", chinese: "å¥¹" },
            { english: "it", chinese: "å®ƒ" },
            { english: "we", chinese: "æˆ‘å€‘" },
            { english: "they", chinese: "ä»–å€‘" },
            { english: "am", chinese: "æ˜¯" },
            { english: "is", chinese: "æ˜¯" },
            { english: "are", chinese: "æ˜¯" },
            { english: "father", chinese: "çˆ¸çˆ¸" },
            { english: "mother", chinese: "åª½åª½" },
            { english: "brother", chinese: "å…„å¼Ÿ" },
            { english: "sister", chinese: "å§Šå¦¹" },
            { english: "family", chinese: "å®¶åº­" },
            { english: "friend", chinese: "æœ‹å‹" },
            { english: "teacher", chinese: "è€å¸«" },
            { english: "student", chinese: "å­¸ç”Ÿ" },
            { english: "boy", chinese: "ç”·å­©" },
            { english: "girl", chinese: "å¥³å­©" },
            { english: "apple", chinese: "è˜‹æœ" },
            { english: "banana", chinese: "é¦™è•‰" },
            { english: "cat", chinese: "è²“" },
            { english: "dog", chinese: "ç‹—" },
            { english: "book", chinese: "æ›¸" },
            { english: "pen", chinese: "ç­†" },
            { english: "chair", chinese: "æ¤…å­" },
            { english: "table", chinese: "æ¡Œå­" },
            { english: "water", chinese: "æ°´" },
            { english: "milk", chinese: "ç‰›å¥¶" },
            { english: "happy", chinese: "å¿«æ¨‚çš„" },
            { english: "sad", chinese: "é›£éçš„" },
            { english: "big", chinese: "å¤§çš„" },
            { english: "small", chinese: "å°çš„" },
            { english: "hot", chinese: "ç†±çš„" },
            { english: "cold", chinese: "å†·çš„" },
            { english: "good", chinese: "å¥½" },
            { english: "bad", chinese: "å£" },
            { english: "new", chinese: "æ–°" },
            { english: "old", chinese: "èˆŠ" },
            { english: "run", chinese: "è·‘" },
            { english: "walk", chinese: "èµ°" },
            { english: "jump", chinese: "è·³" },
            { english: "sit", chinese: "å" },
            { english: "stand", chinese: "ç«™" },
            { english: "sleep", chinese: "ç¡" },
            { english: "eat", chinese: "åƒ" },
            { english: "drink", chinese: "å–" },
            { english: "Monday", chinese: "æ˜ŸæœŸä¸€" },
            { english: "Tuesday", chinese: "æ˜ŸæœŸäºŒ" },
            { english: "Wednesday", chinese: "æ˜ŸæœŸä¸‰" },
            { english: "Thursday", chinese: "æ˜ŸæœŸå››" },
            { english: "Friday", chinese: "æ˜ŸæœŸäº”" },
            { english: "Saturday", chinese: "æ˜ŸæœŸå…­" },
            { english: "Sunday", chinese: "æ˜ŸæœŸæ—¥" },
            { english: "one", chinese: "ä¸€" },
            { english: "two", chinese: "äºŒ" },
            { english: "three", chinese: "ä¸‰" },
            { english: "four", chinese: "å››" },
            { english: "five", chinese: "äº”" },
            { english: "six", chinese: "å…­" },
            { english: "seven", chinese: "ä¸ƒ" },
            { english: "eight", chinese: "å…«" },
            { english: "nine", chinese: "ä¹" },
            { english: "ten", chinese: "å" },
            { english: "red", chinese: "ç´…è‰²" },
            { english: "blue", chinese: "è—è‰²" },
            { english: "green", chinese: "ç¶ è‰²" },
            { english: "yellow", chinese: "é»ƒè‰²" },
            { english: "black", chinese: "é»‘è‰²" },
            { english: "white", chinese: "ç™½è‰²" },
            { english: "home", chinese: "å®¶" },
            { english: "school", chinese: "å­¸æ ¡" },
            { english: "park", chinese: "å…¬åœ’" },
            { english: "store", chinese: "å•†åº—" },
            { english: "car", chinese: "æ±½è»Š" },
            { english: "bus", chinese: "å…¬è»Š" },
            { english: "bike", chinese: "è…³è¸è»Š" },
            { english: "train", chinese: "ç«è»Š" },
            { english: "morning", chinese: "æ—©ä¸Š" },
            { english: "afternoon", chinese: "ä¸‹åˆ" },
            { english: "evening", chinese: "æ™šä¸Š" },
            { english: "night", chinese: "å¤œæ™š" },
            { english: "spring", chinese: "æ˜¥å¤©" },
            { english: "summer", chinese: "å¤å¤©" },
            { english: "autumn", chinese: "ç§‹å¤©" },
            { english: "winter", chinese: "å†¬å¤©" },
            { english: "sun", chinese: "å¤ªé™½" },
            { english: "moon", chinese: "æœˆäº®" },
            { english: "star", chinese: "æ˜Ÿæ˜Ÿ" },
            { english: "rain", chinese: "é›¨" },
            { english: "snow", chinese: "é›ª" },
            { english: "wind", chinese: "é¢¨" },
            { english: "flower", chinese: "èŠ±" },
            { english: "tree", chinese: "æ¨¹" },
            { english: "grass", chinese: "è‰" },
            { english: "river", chinese: "æ²³" },
            { english: "mountain", chinese: "å±±" },
            { english: "sea", chinese: "æµ·" }
        ];

        // ==========================================
        // éŠæˆ²ç‹€æ…‹
        // ==========================================
        
        let gridSize = null;
        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let totalPairs = 0;
        let startTime = null;
        let timerInterval = null;
        let canFlip = true;

        // ==========================================
        // èªéŸ³ç³»çµ±
        // ==========================================
        
        const Speech = {
            synth: window.speechSynthesis,
            voice: null,
            
            init() {
                const voices = this.synth.getVoices();
                this.voice = voices.find(v => v.lang === 'en-US') || voices[0];
            },
            
            speak(text) {
                if (!this.synth) return;
                this.synth.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.voice = this.voice;
                utterance.rate = 0.8;
                utterance.pitch = 1;
                this.synth.speak(utterance);
            }
        };

        // åˆå§‹åŒ–èªéŸ³
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = () => Speech.init();
        }
        Speech.init();

        // ==========================================
        // å·¥å…·å‡½æ•¸
        // ==========================================
        
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function playSound(type) {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            if (type === 'success') {
                oscillator.frequency.value = 800;
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.3);
            } else {
                oscillator.frequency.value = 200;
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.2);
            }
        }

        // ==========================================
        // é¦–é é‚è¼¯
        // ==========================================
        
        document.getElementById('startBtn').addEventListener('click', () => {
            document.getElementById('difficultySelector').classList.add('show');
        });

        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                gridSize = btn.dataset.size;
                startGame();
            });
        });

        // ==========================================
        // é–‹å§‹éŠæˆ²
        // ==========================================
        
        function startGame() {
            // é‡ç½®ç‹€æ…‹
            matchedPairs = 0;
            flippedCards = [];
            canFlip = true;
            
            // è¨ˆç®—éœ€è¦çš„å¡ç‰‡æ•¸é‡
            const [rows, cols] = gridSize.split('x').map(Number);
            totalPairs = (rows * cols) / 2;
            
            // éš¨æ©Ÿé¸æ“‡å–®å­—
            const selectedWords = shuffleArray([...VOCABULARY]).slice(0, totalPairs);
            
            // å‰µå»ºå¡ç‰‡å°
            cards = [];
            selectedWords.forEach((word, index) => {
                cards.push({ 
                    id: index * 2, 
                    text: word.english, 
                    type: 'english',
                    pairId: index 
                });
                cards.push({ 
                    id: index * 2 + 1, 
                    text: word.chinese, 
                    type: 'chinese',
                    pairId: index 
                });
            });
            
            // æ´—ç‰Œ
            cards = shuffleArray(cards);
            
            // è¨­å®šç¶²æ ¼
            const grid = document.getElementById('cardsGrid');
            grid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
            
            // æ¸²æŸ“å¡ç‰‡
            grid.innerHTML = cards.map(card => `
                <div class="card" data-id="${card.id}" data-pair="${card.pairId}" data-text="${card.text}" data-type="${card.type}">
                    ?
                </div>
            `).join('');
            
            // ç¶å®šé»æ“Šäº‹ä»¶
            document.querySelectorAll('.card').forEach(card => {
                card.addEventListener('click', () => flipCard(card));
            });
            
            // åˆ‡æ›ç•«é¢
            document.getElementById('homeScreen').style.display = 'none';
            document.getElementById('gameScreen').classList.add('active');
            
            // å•Ÿå‹•è¨ˆæ™‚å™¨
            startTimer();
            updateScore();
        }

        // ==========================================
        // ç¿»ç‰Œé‚è¼¯
        // ==========================================
        
        function flipCard(cardElement) {
            if (!canFlip) return;
            if (cardElement.classList.contains('flipped')) return;
            if (cardElement.classList.contains('matched')) return;
            if (flippedCards.length >= 2) return;
            
            // ç¿»ç‰Œ
            cardElement.classList.add('flipped');
            cardElement.textContent = cardElement.dataset.text;
            
            // èªéŸ³æœ—è®€è‹±æ–‡
            if (cardElement.dataset.type === 'english') {
                Speech.speak(cardElement.dataset.text);
            }
            
            flippedCards.push(cardElement);
            
            // æª¢æŸ¥é…å°
            if (flippedCards.length === 2) {
                canFlip = false;
                setTimeout(checkMatch, 800);
            }
        }

        // ==========================================
        // æª¢æŸ¥é…å°
        // ==========================================
        
        function checkMatch() {
            const [card1, card2] = flippedCards;
            const pair1 = card1.dataset.pair;
            const pair2 = card2.dataset.pair;
            
            if (pair1 === pair2) {
                // é…å°æˆåŠŸ!
                card1.classList.add('matched');
                card2.classList.add('matched');
                matchedPairs++;
                
                playSound('success');
                updateScore();
                
                // æª¢æŸ¥æ˜¯å¦å®Œæˆ
                if (matchedPairs === totalPairs) {
                    setTimeout(endGame, 500);
                }
            } else {
                // é…å°å¤±æ•—
                card1.classList.add('wrong');
                card2.classList.add('wrong');
                
                playSound('wrong');
                
                setTimeout(() => {
                    card1.classList.remove('flipped', 'wrong');
                    card2.classList.remove('flipped', 'wrong');
                    card1.textContent = '?';
                    card2.textContent = '?';
                }, 1000);
            }
            
            flippedCards = [];
            setTimeout(() => { canFlip = true; }, 1000);
        }

        // ==========================================
        // è¨ˆæ™‚å™¨
        // ==========================================
        
        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('timer').textContent = 
                    `â±ï¸ ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // ==========================================
        // æ›´æ–°åˆ†æ•¸
        // ==========================================
        
        function updateScore() {
            document.getElementById('score').textContent = `é…å°: ${matchedPairs}/${totalPairs}`;
        }

        // ==========================================
        // éŠæˆ²çµæŸ
        // ==========================================
        
        function endGame() {
            clearInterval(timerInterval);
            
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            
            const resultHTML = `
                <div>â±ï¸ å®Œæˆæ™‚é–“: ${minutes}:${seconds.toString().padStart(2, '0')}</div>
                <div>ğŸ¯ é…å°æ•¸: ${matchedPairs} çµ„</div>
                <div>ğŸ“Š é›£åº¦: ${gridSize === '4x4' ? 'ç°¡å–®' : 'ä¸­ç­‰'}</div>
                <div style="margin-top: 30px; font-size: 2em;">
                    ${elapsed < 60 ? 'ğŸ† å¤ªå²å®³äº†!' : elapsed < 120 ? 'ğŸ‘ åšå¾—å¥½!' : 'ğŸ’ª ç¹¼çºŒåŠªåŠ›!'}
                </div>
            `;
            
            document.getElementById('resultStats').innerHTML = resultHTML;
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultScreen').classList.add('active');
        }

        // ==========================================
        // è¿”å›é¦–é 
        // ==========================================
        
        function resetToHome() {
            clearInterval(timerInterval);
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultScreen').classList.remove('active');
            document.getElementById('homeScreen').style.display = 'block';
            document.getElementById('difficultySelector').classList.remove('show');
            gridSize = null;
        }

        document.getElementById('backBtn').addEventListener('click', resetToHome);
        document.getElementById('homeBtn').addEventListener('click', resetToHome);
        document.getElementById('playAgainBtn').addEventListener('click', () => {
            document.getElementById('resultScreen').classList.remove('active');
            if (gridSize) {
                startGame();
            } else {
                resetToHome();
            }
        });
    </script>
</body>
</html>
